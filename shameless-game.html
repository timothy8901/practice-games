<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shameless Trivia-Tac-Toe</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Game board cell */
        .game-cell {
            width: 100px;
            height: 100px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        /* Larger board for tablets and desktops */
        @media (min-width: 640px) {
            .game-cell {
                width: 140px;
                height: 140px;
            }
        }

        /* 'X' and 'O' marker styles */
        .game-cell.x {
            color: #60a5fa; /* Tailwind blue-400 */
        }
        .game-cell.o {
            color: #f472b6; /* Tailwind pink-400 */
        }

        /* Modal overlay */
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
        
        /* Modal content */
        .modal-content {
            transition: all 0.3s ease;
            transform: translateY(20px) scale(0.95);
        }
        
        /* Modal show state */
        .modal-overlay.flex:not(.hidden) {
            opacity: 1;
        }
        .modal-overlay.flex:not(.hidden) .modal-content {
            transform: translateY(0) scale(1);
        }

        /* Answer button states */
        .btn-option:disabled {
            opacity: 0.7;
        }
        .btn-correct {
            background-color: #22c55e !important; /* Tailwind green-500 */
            border-color: #16a34a !important; /* Tailwind green-600 */
            color: white !important;
        }
        .btn-incorrect {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            border-color: #dc2626 !important; /* Tailwind red-600 */
            color: white !important;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">

    <!-- Main Game Container -->
    <div class="w-full max-w-md mx-auto text-center">
        <h1 class="text-3xl sm:text-4xl font-black uppercase tracking-wider text-white mb-2">
            Trivia-Tac-Toe
        </h1>
        <p class="text-lg sm:text-xl text-gray-400 mb-6">The Shameless Edition</p>
        
        <!-- Status Display -->
        <h2 id="status-display" class="text-2xl font-bold mb-6 text-blue-400">Player X's Turn</h2>
        
        <!-- Game Board -->
        <div id="game-board" class="grid grid-cols-3 gap-2 sm:gap-3 bg-gray-900 rounded-lg max-w-sm mx-auto">
            <!-- Cells will be generated by JS, but here's the template -->
            <div data-index="0" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="1" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="2" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="3" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="4" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="5" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="6" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="7" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
            <div data-index="8" class="game-cell bg-gray-800 rounded-lg flex items-center justify-center text-5xl sm:text-7xl font-black shadow-inner"></div>
        </div>
        
        <!-- Restart Button -->
        <button id="restart-button" class="mt-8 bg-pink-600 hover:bg-pink-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
            Restart Game
        </button>
    </div>

    <!-- Trivia Modal -->
    <div id="trivia-modal" class="modal-overlay hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 opacity-0">
        <div class="modal-content bg-gray-800 w-full max-w-lg rounded-2xl shadow-2xl p-6 sm:p-8 border border-gray-700">
            <!-- Difficulty Badge -->
            <span id="difficulty-badge" class="inline-block bg-yellow-500 text-gray-900 text-xs font-bold px-3 py-1 rounded-full uppercase mb-4">
                Regular Question
            </span>
            
            <!-- Question Text -->
            <h2 id="question-text" class="text-xl sm:text-2xl font-bold text-white mb-6">
                This is a placeholder for the trivia question?
            </h2>
            
            <!-- Options Container -->
            <div id="options-container" class="flex flex-col space-y-3">
                <!-- Option buttons will be populated by JS -->
            </div>
            
            <!-- Result Message -->
            <div id="result-message" class="text-center text-2xl font-bold mt-6 h-8">
                <!-- "Correct!" or "Incorrect!" -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- STATE VARIABLES ---
            let currentPlayer = 'X';
            let board = ['', '', '', '', '', '', '', '', ''];
            let gameActive = true;
            let currentQuestion = null;
            let selectedCellIndex = null;
            let questionsUsed = {
                regular: [],
                hard: []
            };

            // --- TRIVIA QUESTIONS ---
            const allQuestions = {
                regular: [
                    { q: "What is the name of the Gallagher family's neighborhood bar?", o: ["The Alibi Room", "Patsy's Pies", "The Jockey", "Moe's Tavern"], a: "The Alibi Room" },
                    { q: "What is the name of the diner where Fiona worked in the early seasons?", o: ["Patsy's Pies", "The Alibi Room", "World Wide Pants", "The Golden House"], a: "Patsy's Pies" },
                    { q: "Which Gallagher sibling is known for exceptional intelligence?", o: ["Lip", "Ian", "Carl", "Debbie"], a: "Lip" },
                    { q: "What is the name of the character who marries Ian in prison?", o: ["Mickey Milkovich", "Trevor", "Kash", "Caleb"], a: "Mickey Milkovich" },
                    { q: "What mental illness does Ian Gallagher have?", o: ["Bipolar Disorder", "Schizophrenia", "OCD", "Depression"], a: "Bipolar Disorder" },
                    { q: "Who is the biological father of Debbie's baby, Franny?", o: ["Derek", "Matty", "Neil", "Frank"], a: "Derek" },
                    { q: "What country does Svetlana, Mickey's wife, originally come from?", o: ["Russia", "Ukraine", "Poland", "Belarus"], a: "Russia" },
                    { q: "What is the name of the youngest Gallagher child?", o: ["Liam", "Franny", "Chuckie", "Sammi"], a: "Liam" },
                    { q: "Who burns down the Gallagher house near the end of season 6?", o: ["Monica", "Frank", "Carl", "Lip"], a: "Monica" },
                    { q: "What illegal business do Kevin and Veronica run out of The Alibi?", o: ["A brothel", "Selling drugs", "Illegal gambling", "Counterfeit money"], a: "A brothel" },
                    { q: "What school does Carl attend in season 5?", o: ["Military School", "Police Academy", "Art School", "Culinary School"], a: "Military School" },
                    { q: "What is the name of Fiona's first serious, wealthy boyfriend?", o: ["Steve/Jimmy", "Mike", "Gus", "Sean"], a: "Steve/Jimmy" },
                    { q: "What is the 'Kash and Grab'?", o: ["A convenience store", "A strip club", "A pawn shop", "A bar"], a: "A convenience store" },
                    { q: "What is the name of Sheila Jackson's agoraphobic daughter?", o: ["Karen", "Mandy", "Jody", "Ethel"], a: "Karen" },
                    { q: "What does Frank try to smuggle from Canada?", o: ["Orphan children", "Prescription drugs", "Alcohol", "Guns"], a: "Prescription drugs" },
                    { q: "What is the name of Lip's college professor and mentor?", o: ["Professor Youens", "Professor Tuchman", "Professor Hearst", "Professor Slade"], a: "Professor Youens" },
                    { q: "Who is Sammi Slott?", o: ["Frank's daughter", "Frank's sister", "Carl's girlfriend", "Fiona's boss"], a: "Frank's daughter" },
                    { q: "What animal does Frank hit with his car, believing it's Fiona?", o: ["A dog", "A deer", "A squirrel", "A person"], a: "A dog" }
                ],
                hard: [
                    { q: "What is the name of the 'gentrifier' coffee shop that Lip protests?", o: ["Wexler's", "The Alibi", "Patsy's", "Southside Grind"], a: "Wexler's" },
                    { q: "What was the name of Frank's mother's meth-making girlfriend?", o: ["Queenie", "Roberta", "Bianca", "G-Dogg"], a: "Queenie" },
                    { q: "What is the name of the commune where Monica lives with her girlfriend, Roberta?", o: ["The 'Born Free' commune", "Gallagher's Gulch", "The Sanctuary", "New Genesis"], a: "The 'Born Free' commune" },
                    { q: "What is the name of the child Ian and Mickey unofficially 'adopt'?", o: ["Yevgeny", "Dmitri", "Franny", "Liam"], a: "Yevgeny" },
                    { q: "What household item do the Gallaghers use to collect the 'Squirrel Fund'?", o: ["A large plastic jug", "A coffee can", "A shoebox", "A cookie jar"], a: "A large plastic jug" },
                    { q: "What is the name of the musician Fiona marries and quickly divorces?", o: ["Gus Pfender", "Sean Pierce", "Mike Pratt", "Robbie"], a: "Gus Pfender" }
                ]
            };
            
            const winningConditions = [
                [0, 1, 2],
                [3, 4, 5],
                [6, 7, 8],
                [0, 3, 6],
                [1, 4, 7],
                [2, 5, 8],
                [0, 4, 8],
                [2, 4, 6]
            ];

            // --- DOM ELEMENTS ---
            const statusDisplay = document.getElementById('status-display');
            const gameBoard = document.getElementById('game-board');
            const restartButton = document.getElementById('restart-button');
            const modal = document.getElementById('trivia-modal');
            const questionText = document.getElementById('question-text');
            const difficultyBadge = document.getElementById('difficulty-badge');
            const optionsContainer = document.getElementById('options-container');
            const resultMessage = document.getElementById('result-message');
            const cells = document.querySelectorAll('.game-cell');

            // --- FUNCTIONS ---

            function initializeGame() {
                cells.forEach(cell => {
                    cell.innerText = '';
                    cell.classList.remove('x', 'o');
                    cell.addEventListener('click', handleCellClick);
                });
                board = ['', '', '', '', '', '', '', '', ''];
                currentPlayer = 'X';
                gameActive = true;
                statusDisplay.innerText = "Player X's Turn";
                statusDisplay.className = "text-2xl font-bold mb-6 text-blue-400";
                questionsUsed.regular = [];
                questionsUsed.hard = [];
                hideModal();
            }

            function handleCellClick(event) {
                const clickedCell = event.target;
                const clickedCellIndex = parseInt(clickedCell.getAttribute('data-index'));

                if (!gameActive || board[clickedCellIndex] === currentPlayer) {
                    return; // Ignore click if game is over or cell is already owned by player
                }

                selectedCellIndex = clickedCellIndex;
                const targetState = board[clickedCellIndex];

                if (targetState === '') {
                    // Empty cell: Regular question
                    currentQuestion = getQuestion('regular');
                    showModal(currentQuestion, 'Regular');
                } else {
                    // Opponent's cell: Hard "steal" question
                    currentQuestion = getQuestion('hard');
                    showModal(currentQuestion, 'Hard (Steal!)');
                }
            }
            
            function getQuestion(difficulty) {
                let availableQuestions = allQuestions[difficulty].filter((_, index) => !questionsUsed[difficulty].includes(index));

                // If all questions of this type have been used, reset the used list
                if (availableQuestions.length === 0) {
                    questionsUsed[difficulty] = [];
                    availableQuestions = allQuestions[difficulty];
                }

                const questionIndex = Math.floor(Math.random() * availableQuestions.length);
                const question = availableQuestions[questionIndex];
                
                // Find original index to mark as used
                const originalIndex = allQuestions[difficulty].indexOf(question);
                questionsUsed[difficulty].push(originalIndex);

                return question;
            }

            function showModal(question, difficultyLabel) {
                questionText.innerText = question.q;
                difficultyBadge.innerText = difficultyLabel;
                
                // Set badge color
                if (difficultyLabel.includes('Hard')) {
                    difficultyBadge.className = "inline-block bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full uppercase mb-4";
                } else {
                    difficultyBadge.className = "inline-block bg-yellow-500 text-gray-900 text-xs font-bold px-3 py-1 rounded-full uppercase mb-4";
                }

                optionsContainer.innerHTML = ''; // Clear old options
                resultMessage.innerText = '';

                question.o.forEach(option => {
                    const button = document.createElement('button');
                    button.innerText = option;
                    button.classList.add('btn-option', 'w-full', 'bg-gray-700', 'hover:bg-gray-600', 'text-white', 'font-semibold', 'py-3', 'px-4', 'rounded-lg', 'transition', 'duration-200', 'ease-in-out', 'border-2', 'border-gray-600', 'focus:outline-none', 'focus:ring-2', 'focus:ring-pink-500');
                    button.addEventListener('click', handleAnswerClick);
                    optionsContainer.appendChild(button);
                });

                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10); // Start transition
            }

            function hideModal() {
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300); // Wait for transition
                currentQuestion = null;
                selectedCellIndex = null;
            }

            function handleAnswerClick(event) {
                const selectedAnswer = event.target.innerText;
                const correct = selectedAnswer === currentQuestion.a;

                // Disable all buttons
                optionsContainer.querySelectorAll('button').forEach(btn => {
                    btn.disabled = true;
                    // Show correct answer if user was wrong
                    if (btn.innerText === currentQuestion.a) {
                        btn.classList.add('btn-correct');
                    }
                });

                if (correct) {
                    event.target.classList.add('btn-correct');
                    resultMessage.innerText = 'Correct!';
                    resultMessage.className = 'text-center text-2xl font-bold mt-6 h-8 text-green-500';
                    setTimeout(processCorrectAnswer, 1200);
                } else {
                    event.target.classList.add('btn-incorrect');
                    resultMessage.innerText = 'Incorrect!';
                    resultMessage.className = 'text-center text-2xl font-bold mt-6 h-8 text-red-500';
                    setTimeout(processIncorrectAnswer, 1200);
                }
            }
            
            function processCorrectAnswer() {
                // Place or steal the square
                board[selectedCellIndex] = currentPlayer;
                const cell = cells[selectedCellIndex];
                cell.innerText = currentPlayer;
                cell.classList.remove('x', 'o'); // Remove old class if it was a steal
                cell.classList.add(currentPlayer === 'X' ? 'x' : 'o');
                
                hideModal();

                if (checkWin()) {
                    endGame(false);
                } else if (checkDraw()) {
                    endGame(true);
                } else {
                    switchPlayer();
                }
            }

            function processIncorrectAnswer() {
                // Do nothing to the board, just switch player
                hideModal();
                switchPlayer();
            }

            function switchPlayer() {
                currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                statusDisplay.innerText = `Player ${currentPlayer}'s Turn`;
                statusDisplay.className = `text-2xl font-bold mb-6 ${currentPlayer === 'X' ? 'text-blue-400' : 'text-pink-400'}`;
            }

            function checkWin() {
                return winningConditions.some(condition => {
                    return condition.every(index => {
                        return board[index] === currentPlayer;
                    });
                });
            }

            function checkDraw() {
                return !board.includes('');
            }
            
            function endGame(isDraw) {
                gameActive = false;
                if (isDraw) {
                    statusDisplay.innerText = "It's a Draw!";
                    statusDisplay.className = "text-2xl font-bold mb-6 text-yellow-500";
                } else {
                    statusDisplay.innerText = `Player ${currentPlayer} Wins!`;
                    statusDisplay.className = `text-2xl font-bold mb-6 ${currentPlayer === 'X' ? 'text-blue-400' : 'text-pink-400'}`;
                }
            }

            // --- EVENT LISTENERS ---
            restartButton.addEventListener('click', initializeGame);
            
            // Initial game setup
            initializeGame();
        });
    </script>
</body>
</html>

